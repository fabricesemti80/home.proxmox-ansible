# {{ ansible_managed }}
# network interface settings; autogenerated
# Please do NOT modify this file directly, unless you know what
# you're doing.
#
# If you want to manage parts of the network configuration manually,
# please utilize the 'source' or 'source-directory' directives to do
# so.
# PVE will preserve these directives, but will NOT read its network
# configuration from sourced files, so do not attempt to move any of
# the PVE managed interfaces into external files!

auto lo
iface lo inet loopback

iface enp2s0 inet manual

# USB Network Physical Interfaces (Ceph & VM Storage)
{% if inventory_hostname == 'pve-0.fabricesemti.dev' %}
iface enx7cc2c64ca36f inet manual
{% elif inventory_hostname == 'pve-1.fabricesemti.dev' %}
iface enx7cc2c64b6389 inet manual
{% elif inventory_hostname == 'pve-2.fabricesemti.dev' %}
iface enx7cc2c64b4dc4 inet manual
{% endif %}

# Ceph and VM Storage Bridge
auto vmbr1
iface vmbr1 inet static
{% if inventory_hostname == 'pve-0.fabricesemti.dev' %}
    address 10.0.70.10/24
    bridge-ports enx7cc2c64ca36f
{% elif inventory_hostname == 'pve-1.fabricesemti.dev' %}
    address 10.0.70.11/24
    bridge-ports enx7cc2c64b6389
{% elif inventory_hostname == 'pve-2.fabricesemti.dev' %}
    address 10.0.70.12/24
    bridge-ports enx7cc2c64b4dc4
{% endif %}
    bridge-stp off
    bridge-fd 0
    description Ceph and VM Storage Network

# Primary Management Bridge
auto vmbr0
iface vmbr0 inet static
    address 10.0.40.{{ ansible_host.split('.')[-1] }}/24
    gateway 10.0.40.1
    bridge-ports enp2s0
    bridge-stp off
    bridge-fd 0

iface wlp3s0 inet manual

source /etc/network/interfaces.d/*
